{%- liquid
  assign s = section.settings
  assign collection = collections[s.collection]
-%}

<div class="featured-products">
  {%- if s.show_header -%}
    <div class="featured-products__header rounded">
      {%- if s.title != blank -%}
        <h2 class="featured-products__title h2">{{ s.title }}</h2>
      {%- endif -%}

      <div class="featured-products__body-wrapper">
        {%- if s.body != blank -%}
          <p class="featured-products__body">{{ s.body }}</p>
        {%- endif -%}

        {%- if s.button_text != blank and s.button_link != blank -%}
          <a href="{{ s.button_link }}" class="button hover-scale">
            {{ s.button_text }}
          </a>
        {%- endif -%}
      </div>
    </div>
  {%- endif -%}

  {%- if collection != blank -%}
    <wakey-slider class="featured-products__slider" autoplay-direction="backward">
      <div class="slider--wrapper">
        {%- for product in collection.products limit: s.products_limit -%}
          <div class="featured-products__slide">
            {% render 'product-card', product: product %}
          </div>
        {%- endfor -%}
        {%- for product in collection.products limit: s.products_limit -%}
          <div class="featured-products__slide">
            {% render 'product-card', product: product %}
          </div>
        {%- endfor -%}
        {%- for product in collection.products limit: s.products_limit -%}
          <div class="featured-products__slide">
            {% render 'product-card', product: product %}
          </div>
        {%- endfor -%}
      </div>
    </wakey-slider>
  {%- else -%}
    <p class="featured-products__empty">Please select a collection to display products.</p>
  {%- endif -%}
</div>

{% stylesheet %}
  .featured-products {
    width: 100%;
    position: relative;
    overflow: hidden;
  }

  /* Header Styles */
  .featured-products__header {
    background-color: #c5d8f0; /* Light blue like in the design */
    padding: calc(var(--padding) * 2);
    margin-bottom: var(--padding);
    text-align: left;
    position: relative;
    overflow: hidden;
  }

  .featured-products__title {
    margin-bottom: var(--padding);
  }

  .featured-products__body-wrapper {
    padding-top: calc(var(--padding) * 11);
  }

  .featured-products__body {
    font-family: var(--font-itc);
  }

  /* Slider Styles */
  .featured-products__slide {
    min-width: 100%;
    padding: 0;
    width: 50vw;
  }

  .featured-products__empty {
    text-align: center;
    padding: calc(var(--padding) * 4) calc(var(--padding) * 2);
  }

  /* Desktop Styles */
  @media (width >= 47rem) {
    .featured-products__header {
      padding: calc(var(--padding) * 4);
      margin-bottom: calc(var(--padding) * 2);
    }

    .featured-products__slide {
      width: 39rem;

      padding: 0;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Featured Products",
  "class": "featured-products-section",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_header",
      "label": "Show header",
      "default": true,
      "info": "Toggle to show or hide the header section"
    },
    {
      "type": "richtext",
      "id": "title",
      "label": "Title",
      "default": "<p>>Morning <em>starters</em></p>",
      "visible_if": "{{ section.settings.show_header == true }}"
    },
    {
      "type": "textarea",
      "id": "body",
      "label": "Body text",
      "default": "Formulated without aluminum, baking soda, exfoliating acids or any other ingredients that are harmful",
      "visible_if": "{{ section.settings.show_header == true }}"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button text",
      "default": "Shop all",
      "visible_if": "{{ section.settings.show_header == true }}"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button link",
      "visible_if": "{{ section.settings.show_header == true }}"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection",
      "info": "Select the collection to display products from"
    },
    {
      "type": "range",
      "id": "products_limit",
      "label": "Number of products",
      "min": 3,
      "max": 12,
      "step": 1,
      "default": 6
    }
  ],
  "presets": [
    {
      "name": "Featured Products"
    }
  ]
}
{% endschema %}
